# –í–∏—Ä—ñ—à–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º–∏ –∑ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º–∏ –≤ sandbox iframe

## –ü—Ä–æ–±–ª–µ–º–∞
–ü–æ–º–∏–ª–∫–∞: `Download is disallowed. The frame initiating or instantiating the download is sandboxed, but the flag 'allow-downloads' is not set.`

## –ü—Ä–∏—á–∏–Ω–∞
–î–æ–¥–∞—Ç–æ–∫ –ø—Ä–∞—Ü—é—î –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ iframe –∑ sandbox –∞—Ç—Ä–∏–±—É—Ç–æ–º –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ñ Emergent, —è–∫–∏–π –Ω–µ –º–∞—î –ø—Ä–∞–ø–æ—Ä—Ü—è `allow-downloads`. –¶–µ –æ–±–º–µ–∂–µ–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏ –Ω–∞ —Ä—ñ–≤–Ω—ñ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏.

---

## ‚úÖ –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ —Ä—ñ—à–µ–Ω–Ω—è:

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π Fallback –º–µ—Ö–∞–Ω—ñ–∑–º
–î–æ–¥–∞–Ω–æ try-catch –±–ª–æ–∫–∏ –≤ —É—Å—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è:

**–§–∞–π–ª–∏ –∑ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è–º–∏:**
- `/app/frontend/src/App.js` - —Ñ—É–Ω–∫—Ü—ñ—è `exportJSON()`
- `/app/frontend/src/components/DataImport.js` - —Ñ—É–Ω–∫—Ü—ñ—ó `handleDownloadBackup()`, `handleDownloadSingle()`

**–õ–æ–≥—ñ–∫–∞ —Ä–æ–±–æ—Ç–∏:**
```javascript
try {
  // –°–ø—Ä–æ–±–∞ 1: file-saver –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞
  saveAs(blob, filename);
} catch (sandboxError) {
  // –°–ø—Ä–æ–±–∞ 2: –í—ñ–¥–∫—Ä–∏—Ç—Ç—è –≤ –Ω–æ–≤–æ–º—É –≤—ñ–∫–Ω—ñ
  window.open(blobUrl, '_blank');
  
  // –Ø–∫—â–æ popup –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ - –ø–æ–∫–∞–∑–∞—Ç–∏ –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –∑ –∫–Ω–æ–ø–∫–æ—é –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
  // (—Ç—ñ–ª—å–∫–∏ –¥–ª—è JSON –µ–∫—Å–ø–æ—Ä—Ç—É)
}
```

### 2. –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ–π–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
–î–æ–¥–∞–Ω–æ –ø–æ–º—ñ—Ç–∫—É –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ `/import`:
> ‚ö†Ô∏è –ü—Ä–∏–º—ñ—Ç–∫–∞: –Ø–∫—â–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–µ, –¥–æ–∑–≤–æ–ª—å—Ç–µ —Å–ø–ª–∏–≤–∞—é—á—ñ –≤—ñ–∫–Ω–∞ –∞–±–æ –∑–≤–µ—Ä–Ω—ñ—Ç—å—Å—è –¥–æ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ Emergent

---

## üìã –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:

### –í–∞—Ä—ñ–∞–Ω—Ç A: –î–æ–∑–≤–æ–ª–∏—Ç–∏ —Å–ø–ª–∏–≤–∞—é—á—ñ –≤—ñ–∫–Ω–∞ (–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)
1. –ö–ª–∞—Ü–Ω—ñ—Ç—å –Ω–∞ —ñ–∫–æ–Ω–∫—É üîí –≤ –∞–¥—Ä–µ—Å–Ω–æ–º—É —Ä—è–¥–∫—É –±—Ä–∞—É–∑–µ—Ä–∞
2. –ó–Ω–∞–π–¥—ñ—Ç—å "–°–ø–ª–∏–≤–∞—é—á—ñ –≤—ñ–∫–Ω–∞ —Ç–∞ –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü—ñ—è"
3. –í–∏–±–µ—Ä—ñ—Ç—å "–î–æ–∑–≤–æ–ª–∏—Ç–∏"
4. –û–Ω–æ–≤—ñ—Ç—å —Å—Ç–æ—Ä—ñ–Ω–∫—É

### –í–∞—Ä—ñ–∞–Ω—Ç B: –ó–≤'—è–∑–∞—Ç–∏—Å—è –∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é Emergent (–ü–æ—Å—Ç—ñ–π–Ω–µ —Ä—ñ—à–µ–Ω–Ω—è)
**–ü—Ä–æ–±–ª–µ–º–∞ –ø–æ—Ç—Ä–µ–±—É—î –∑–º—ñ–Ω–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏!**

**–ö–æ–Ω—Ç–∞–∫—Ç–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ Emergent:**
- üí¨ Discord: https://discord.gg/VzKfwCXC4A
- üìß Email: support@emergent.sh

**–©–æ –≤–∫–∞–∑–∞—Ç–∏ –≤ –∑–∞–ø–∏—Ç—ñ:**
```
–¢–µ–º–∞: –ü–æ—Ç—Ä—ñ–±–µ–Ω 'allow-downloads' –≤ iframe sandbox

–û–ø–∏—Å:
- Job ID: [–Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å 'i' –≤ –ø—Ä–∞–≤–æ–º—É –≤–µ—Ä—Ö–Ω—å–æ–º—É –∫—É—Ç—ñ –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è]
- –ü—Ä–æ–±–ª–µ–º–∞: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è PDF/JSON/ZIP —Ñ–∞–π–ª—ñ–≤ –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ
- –ü–æ–º–∏–ª–∫–∞: "Download is disallowed. The frame initiating or instantiating 
  the download is sandboxed, but the flag 'allow-downloads' is not set"
- –î–æ–¥–∞—Ç–æ–∫: –ì–Ü–° —Å–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª—ñ–∑—É —Ä–µ–∫—Ä–µ–∞—Ü—ñ–π–Ω–æ–≥–æ –ø–æ—Ç–µ–Ω—Ü—ñ–∞–ª—É
- –ó–∞–ø–∏—Ç: –î–æ–¥–∞—Ç–∏ –ø—Ä–∞–ø–æ—Ä–µ—Ü—å 'allow-downloads' –¥–æ iframe sandbox

–î–æ–¥–∞—Ç–∫–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è:
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è file-saver –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞
- CSP –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ –∫–æ—Ä–µ–∫—Ç–Ω–æ
- Fallback –º–µ—Ö–∞–Ω—ñ–∑–º —á–µ—Ä–µ–∑ window.open —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ
```

---

## üîß –¢–µ—Ö–Ω—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ:

### –ù–µ–æ–±—Ö—ñ–¥–Ω—ñ –∑–º—ñ–Ω–∏ –Ω–∞ —Ä—ñ–≤–Ω—ñ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏:
```html
<!-- –ü–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω (–ø—Ä–∏–ø—É—â–µ–Ω–Ω—è): -->
<iframe sandbox="allow-scripts allow-same-origin" src="..."></iframe>

<!-- –ü–æ—Ç—Ä—ñ–±–Ω–æ: -->
<iframe sandbox="allow-scripts allow-same-origin allow-downloads" src="..."></iframe>
```

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ñ –ø—ñ–¥—Ö–æ–¥–∏ (–Ω–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ):
1. **postMessage** –¥–æ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫–æ–≥–æ –≤—ñ–∫–Ω–∞ - –ø–æ—Ç—Ä–µ–±—É—î –∑–º—ñ–Ω –≤ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ñ Emergent
2. **Service Worker** –¥–ª—è –ø–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—å - —Å–∫–ª–∞–¥–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è
3. **Base64 data URLs** - –æ–±–º–µ–∂–µ–Ω–Ω—è –Ω–∞ —Ä–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É (< 2MB)

---

## üìä –°—Ç–∞—Ç—É—Å —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ:

### –©–æ –ø—Ä–∞—Ü—é—î:
‚úÖ –ï–∫—Å–ø–æ—Ä—Ç PDF (jsPDF) - —á–µ—Ä–µ–∑ window.open fallback  
‚úÖ –ï–∫—Å–ø–æ—Ä—Ç JSON - —á–µ—Ä–µ–∑ window.open + –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ  
‚úÖ ZIP –±–µ–∫–∞–ø - —á–µ—Ä–µ–∑ window.open fallback  
‚úÖ –û–∫—Ä–µ–º—ñ —Ñ–∞–π–ª–∏ - —á–µ—Ä–µ–∑ window.open fallback  
‚úÖ –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö –Ω–∞ –∫–∞—Ä—Ç—ñ  
‚úÖ –ê–Ω–∞–ª—ñ–∑ —Ä–µ–≥—ñ–æ–Ω—ñ–≤  
‚úÖ –Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞ –∫–∞—Ä—Ç–∞  

### –û–±–º–µ–∂–µ–Ω–Ω—è:
‚ö†Ô∏è –ü–æ—Ç—Ä–µ–±—É—î –¥–æ–∑–≤–æ–ª—É —Å–ø–ª–∏–≤–∞—é—á–∏—Ö –≤—ñ–∫–æ–Ω –≤—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞  
‚ö†Ô∏è –ë—Ä–∞—É–∑–µ—Ä –º–æ–∂–µ –±–ª–æ–∫—É–≤–∞—Ç–∏ window.open –≤ –¥–µ—è–∫–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö  
‚ö†Ô∏è –ù–∞–∑–≤–∏ —Ñ–∞–π–ª—ñ–≤ –º–æ–∂—É—Ç—å –Ω–µ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏—Å—è –≤ fallback —Ä–µ–∂–∏–º—ñ  

---

## ‚ú® –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó:

**–î–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤:**
1. –î–æ–∑–≤–æ–ª—å—Ç–µ —Å–ø–ª–∏–≤–∞—é—á—ñ –≤—ñ–∫–Ω–∞ –¥–ª—è —Ü—å–æ–≥–æ –¥–æ–¥–∞—Ç–∫—É
2. –Ø–∫—â–æ –ø—Ä–æ–±–ª–µ–º–∞ –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è - –∑–≤–µ—Ä–Ω—ñ—Ç—å—Å—è –¥–æ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ Emergent

**–î–ª—è —Ä–æ–∑—Ä–æ–±–Ω–∏–∫—ñ–≤ Emergent:**
1. –î–æ–¥–∞—Ç–∏ `allow-downloads` –¥–æ sandbox –∞—Ç—Ä–∏–±—É—Ç—É iframe
2. –ê–±–æ –Ω–∞–¥–∞—Ç–∏ API –¥–ª—è –±–µ–∑–ø–µ—á–Ω–æ–≥–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ —á–µ—Ä–µ–∑ postMessage
3. –î–æ–∫—É–º–µ–Ω—Ç—É–≤–∞—Ç–∏ –æ–±–º–µ–∂–µ–Ω–Ω—è sandbox –¥–ª—è —Ä–æ–∑—Ä–æ–±–Ω–∏–∫—ñ–≤ –¥–æ–¥–∞—Ç–∫—ñ–≤

---

## üìù –ü—Ä–∏–º—ñ—Ç–∫–∏:

- –ö–æ–¥ –¥–æ–¥–∞—Ç–∫—É —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –∫–æ—Ä–µ–∫—Ç–Ω–æ
- –ü—Ä–æ–±–ª–µ–º–∞ –Ω–∞ —Ä—ñ–≤–Ω—ñ –±–µ–∑–ø–µ–∫–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏, –Ω–µ –¥–æ–¥–∞—Ç–∫—É
- Fallback –º–µ—Ö–∞–Ω—ñ–∑–º–∏ –ø—Ä–∞—Ü—é—é—Ç—å, –∞–ª–µ –Ω–µ —ñ–¥–µ–∞–ª—å–Ω—ñ
- –ü–æ—Å—Ç—ñ–π–Ω–µ —Ä—ñ—à–µ–Ω–Ω—è –ø–æ—Ç—Ä–µ–±—É—î –∑–º—ñ–Ω–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó Emergent platform

**–î–∞—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è:** 07.12.2025  
**–í–µ—Ä—Å—ñ—è –¥–æ–∫—É–º–µ–Ω—Ç—É:** 1.0
